"use strict";(self.webpackChunkfeshcart=self.webpackChunkfeshcart||[]).push([[971],{971:(v,l,c)=>{c.r(l),c.d(l,{CartComponent:()=>x});var m=c(6814),d=c(1120),t=c(4769),p=c(6286);function _(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11),t._UZ(2,"img",12),t.qZA(),t.TgZ(3,"div",13)(4,"div")(5,"h3",14),t._uU(6),t.qZA(),t.TgZ(7,"p",15),t._uU(8),t.qZA(),t.TgZ(9,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.removeItem(s.product._id))}),t._UZ(10,"i",17),t._uU(11," Remove"),t.qZA()(),t.TgZ(12,"div")(13,"button",18,19),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.MAs(14),C=t.MAs(19),g=t.oxw(2);return t.KtG(g.changeCount(s.count-1,s.product._id,a,C))}),t._uU(15,"-"),t.qZA(),t.TgZ(16,"span",20),t._uU(17),t.qZA(),t.TgZ(18,"button",18,21),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.MAs(14),C=t.MAs(19),g=t.oxw(2);return t.KtG(g.changeCount(s.count+1,s.product._id,a,C))}),t._uU(20,"+"),t.qZA()()()()}if(2&n){const e=h.$implicit;t.xp6(2),t.Q6J("src",e.product.imageCover,t.LSH)("alt",e.product.title),t.xp6(4),t.Oqu(e.product.title),t.xp6(2),t.hij("Price : ",e.price,""),t.xp6(9),t.Oqu(e.count)}}const b=function(n){return["/payment",n]};function o(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"section",2)(1,"div",3)(2,"h1",4),t._uU(3,"Shop Cart"),t.qZA(),t.TgZ(4,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearCart())}),t._uU(5,"clear cart"),t.qZA()(),t.TgZ(6,"p",6),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.YNc(9,_,21,5,"div",7),t.TgZ(10,"button",8),t._uU(11,"Online Payment "),t._UZ(12,"img",9),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(7),t.hij("Total Price :",t.xi3(8,3,e.cartDetails.totalCartPrice,"EGP "),""),t.xp6(2),t.Q6J("ngForOf",e.cartDetails.products),t.xp6(1),t.Q6J("routerLink",t.VKq(6,b,e.cartDetails._id))}}function u(n,h){1&n&&(t.TgZ(0,"h2",22),t._uU(1,"Your Cart Is Empty............."),t.qZA())}let x=(()=>{class n{constructor(e,r){this._CartService=e,this._Renderer2=r,this.cartDetails=null}ngOnInit(){this._CartService.getCartUser().subscribe({next:e=>{console.log("getCarUser",e),this.cartDetails=e.data}})}removeItem(e){this._CartService.removeCartItem(e).subscribe({next:r=>{console.log("removeCart",r),this.cartDetails=r.data,this._CartService.cartNum.next(r.numOfCartItems)}})}changeCount(e,r,i,s){this._Renderer2.setAttribute(i,"disabled","true"),this._Renderer2.setAttribute(s,"disabled","true"),e>=1&&this._CartService.updateCartCount(r,e).subscribe({next:a=>{console.log(a),this.cartDetails=a.data,this._Renderer2.removeAttribute(i,"disabled"),this._Renderer2.removeAttribute(s,"disabled")},error:a=>{this._Renderer2.removeAttribute(i,"disabled"),this._Renderer2.removeAttribute(s,"disabled")}})}clearCart(){this._CartService.clearCart().subscribe({next:e=>{console.log(e.message),"success"===e.message&&(this.cartDetails=null)}})}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(p.N),t.Y36(t.Qsj))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[["class","w-75 shadow rounded bg-main-light mx-auto p-3 my-3",4,"ngIf","ngIfElse"],["msg",""],[1,"w-75","shadow","rounded","bg-main-light","mx-auto","p-3","my-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h2"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"text-main"],["class","row border-bottom py-2",4,"ngFor","ngForOf"],[1,"btn-main","mt-3",3,"routerLink"],["src","./assets/images/visa-1.svg","alt",""],[1,"row","border-bottom","py-2"],[1,"col-md-1"],[1,"w-100",3,"src","alt"],[1,"col-md-11","d-flex","justify-content-between","align-items-center"],[1,"h6"],[1,"text-main","small"],[1,"btn","m-0","p-0","text-danger","small",3,"click"],[1,"fas","fa-trash-can"],[1,"btn","btn-sm","border-success",3,"click"],["btn1",""],[1,"px-1"],["btn2",""],[1,"text-center"]],template:function(r,i){if(1&r&&(t.YNc(0,o,13,8,"section",0),t.YNc(1,u,2,0,"ng-template",null,1,t.W1O)),2&r){const s=t.MAs(2);t.Q6J("ngIf",i.cartDetails)("ngIfElse",s)}},dependencies:[m.ez,m.sg,m.O5,m.H9,d.rH]})}return n})()},6286:(v,l,c)=>{c.d(l,{N:()=>p});var m=c(5619),d=c(4769),t=c(9862);let p=(()=>{class _{constructor(o){this._HttpClient=o,this.cartNum=new m.X(0),this.myToken={token:localStorage.getItem("etoken")||""}}addToCart(o){return this._HttpClient.post("https://ecommerce.routemisr.com/api/v1/cart",{productId:o},{headers:this.myToken})}getCartUser(){return this._HttpClient.get("https://ecommerce.routemisr.com/api/v1/cart",{headers:this.myToken})}removeCartItem(o){return this._HttpClient.delete(`https://ecommerce.routemisr.com/api/v1/cart/${o}`,{headers:this.myToken})}updateCartCount(o,u){return this._HttpClient.put(`https://ecommerce.routemisr.com/api/v1/cart/${o}`,{count:u},{headers:this.myToken})}clearCart(){return this._HttpClient.delete("https://ecommerce.routemisr.com/api/v1/cart",{headers:this.myToken})}checkOut(o,u){return this._HttpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${o}?url=http://localhost:3000`,{shippingAddress:u},{headers:this.myToken})}static#t=this.\u0275fac=function(u){return new(u||_)(d.LFG(t.eN))};static#e=this.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()}}]);